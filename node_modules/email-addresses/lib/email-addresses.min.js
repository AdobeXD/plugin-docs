(function(a){function b(a){function b(){return bG<bH}function c(){return bF[bG]}function d(){return bG}function e(a){bG=a}function f(){bG+=1}function g(){bG=0,bH=bF.length}function i(a,b){return{name:a,tokens:b||"",semantic:b||"",children:[]}}function j(a,b){var c;return b===null?null:(c=i(a),c.tokens=b.tokens,c.semantic=b.semantic,c.children.push(b),c)}function k(a,b){return b!==null&&(a.tokens+=b.tokens,a.semantic+=b.semantic),a.children.push(b),a}function l(a){var d;return b()?(d=c(),a(d)?(f(),i("token",d)):null):null}function m(a){return function(){return j("literal",l(function(b){return b===a}))}}function n(){var a=arguments;return function b(){var b,c,f,g;g=d(),c=i("and");for(b=0;b<a.length;b+=1){f=a[b]();if(f===null)return e(g),null;k(c,f)}return c}}function o(){var a=arguments;return function b(){var b,c,f;f=d();for(b=0;b<a.length;b+=1){c=a[b]();if(c!==null)return c;e(f)}return null}}function p(a){return function b(){var b,c;return c=d(),b=a(),b!==null?b:(e(c),i("opt"))}}function q(a){return function b(){var b=a();return b!==null&&(b.semantic=""),b}}function r(a){return function b(){var b=a();return b!==null&&b.semantic.length>0&&(b.semantic=" "),b}}function s(a,b){return function c(){var c,f,g,h,j;h=d(),c=i("star"),g=0,j=b===undefined?0:b;while((f=a())!==null)g+=1,k(c,f);return g>=j?c:(e(h),null)}}function t(a){return a.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")}function u(a){return a.charCodeAt(0)>=128}function v(){return j("cr",m("\r")())}function w(){return j("crlf",n(v,z)())}function x(){return j("dquote",m('"')())}function y(){return j("htab",m("\t")())}function z(){return j("lf",m("\n")())}function A(){return j("sp",m(" ")())}function B(){return j("vchar",l(function b(b){var c=b.charCodeAt(0),d=33<=c&&c<=126;return a.rfc6532&&(d=d||u(b)),d}))}function C(){return j("wsp",o(A,y)())}function D(){var a=j("quoted-pair",o(n(m("\\"),o(B,C)),bk)());return a===null?null:(a.semantic=a.semantic[1],a)}function E(){return j("fws",o(bm,n(p(n(s(C),q(w))),s(C,1)))())}function F(){return j("ctext",o(function(){return l(function b(b){var c=b.charCodeAt(0),d=33<=c&&c<=39||42<=c&&c<=91||93<=c&&c<=126;return a.rfc6532&&(d=d||u(b)),d})},bi)())}function G(){return j("ccontent",o(F,D,H)())}function H(){return j("comment",n(m("("),s(n(p(E),G)),p(E),m(")"))())}function I(){return j("cfws",o(n(s(n(p(E),H),1),p(E)),E)())}function J(){return j("atext",l(function b(b){var c="a"<=b&&b<="z"||"A"<=b&&b<="Z"||"0"<=b&&b<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(b)>=0;return a.rfc6532&&(c=c||u(b)),c}))}function K(){return j("atom",n(r(p(I)),s(J,1),r(p(I)))())}function L(){var a,b;return a=j("dot-atom-text",s(J,1)()),a===null?a:(b=s(n(m("."),s(J,1)))(),b!==null&&k(a,b),a)}function M(){return j("dot-atom",n(q(p(I)),L,q(p(I)))())}function N(){return j("qtext",o(function(){return l(function b(b){var c=b.charCodeAt(0),d=33===c||35<=c&&c<=91||93<=c&&c<=126;return a.rfc6532&&(d=d||u(b)),d})},bj)())}function O(){return j("qcontent",o(N,D)())}function P(){return j("quoted-string",n(q(p(I)),q(x),s(n(p(r(E)),O)),p(q(E)),q(x),q(p(I)))())}function Q(){return j("word",o(K,P)())}function R(){return j("phrase",o(bl,s(Q,1))())}function S(){return j("address",o(T,W)())}function T(){return j("mailbox",o(U,bd)())}function U(){return j("name-addr",n(p(X),V)())}function V(){return j("angle-addr",o(n(q(p(I)),m("<"),bd,m(">"),q(p(I))),bn)())}function W(){return j("group",n(X,m(":"),p($),m(";"),q(p(I)))())}function X(){return j("display-name",function a(){var a=R();return a!==null&&(a.semantic=t(a.semantic)),a}())}function Y(){return j("mailbox-list",o(n(T,s(n(m(","),T))),bq)())}function Z(){return j("address-list",o(n(S,s(n(m(","),S))),br)())}function $(){return j("group-list",o(Y,q(I),bs)())}function _(){return j("local-part",o(bt,M,P)())}function ba(){return j("dtext",o(function(){return l(function b(b){var c=b.charCodeAt(0),d=33<=c&&c<=90||94<=c&&c<=126;return a.rfc6532&&(d=d||u(b)),d})},bv)())}function bb(){return j("domain-literal",n(q(p(I)),m("["),s(n(p(E),ba)),p(E),m("]"),q(p(I)))())}function bc(){return j("domain",function b(){var b=o(bu,M,bb)();return a.rejectTLD&&b&&b.semantic&&b.semantic.indexOf(".")<0?null:(b&&(b.semantic=b.semantic.replace(/\s+/g,"")),b)}())}function bd(){return j("addr-spec",n(_,m("@"),bc)())}function be(){return j("from",o(Y,Z)())}function bf(){return j("sender",o(T,S)())}function bg(){return j("reply-to",Z())}function bh(){return a.strict?null:j("obs-NO-WS-CTL",l(function(a){var b=a.charCodeAt(0);return 1<=b&&b<=8||11===b||12===b||14<=b&&b<=31||127===b}))}function bi(){return a.strict?null:j("obs-ctext",bh())}function bj(){return a.strict?null:j("obs-qtext",bh())}function bk(){return a.strict?null:j("obs-qp",n(m("\\"),o(m("\0"),bh,z,v))())}function bl(){return a.strict?null:j("obs-phrase",n(Q,s(o(Q,m("."),r(I))))())}function bm(){return a.strict?null:j("obs-FWS",s(n(q(p(w)),C),1)())}function bn(){return a.strict?null:j("obs-angle-addr",n(q(p(I)),m("<"),bo,bd,m(">"),q(p(I)))())}function bo(){return a.strict?null:j("obs-route",n(bp,m(":"))())}function bp(){return a.strict?null:j("obs-domain-list",n(s(o(q(I),m(","))),m("@"),bc,s(n(m(","),q(p(I)),p(n(m("@"),bc)))))())}function bq(){return a.strict?null:j("obs-mbox-list",n(s(n(q(p(I)),m(","))),T,s(n(m(","),p(n(T,q(I))))))())}function br(){return a.strict?null:j("obs-addr-list",n(s(n(q(p(I)),m(","))),S,s(n(m(","),p(n(S,q(I))))))())}function bs(){return a.strict?null:j("obs-group-list",n(s(n(q(p(I)),m(",")),1),q(p(I)))())}function bt(){return a.strict?null:j("obs-local-part",n(Q,s(n(m("."),Q)))())}function bu(){return a.strict?null:j("obs-domain",n(K,s(n(m("."),K)))())}function bv(){return a.strict?null:j("obs-dtext",o(bh,D)())}function bw(a,b){var c,d,e;if(b===null||b===undefined)return null;d=[b];while(d.length>0){e=d.pop();if(e.name===a)return e;for(c=e.children.length-1;c>=0;c-=1)d.push(e.children[c])}return null}function bx(a,b){var c,d,e,f;if(b===null||b===undefined)return null;d=[b],f=[];while(d.length>0){e=d.pop(),e.name===a&&f.push(e);for(c=e.children.length-1;c>=0;c-=1)d.push(e.children[c])}return f}function by(a,b){var c,d,e,f,g;if(b===null||b===undefined)return null;d=[b],f=[],g={};for(c=0;c<a.length;c+=1)g[a[c]]=!0;while(d.length>0){e=d.pop();if(e.name in g)f.push(e);else for(c=e.children.length-1;c>=0;c-=1)d.push(e.children[c])}return f}function bz(b){var c,d,e,f,g;if(b===null)return null;c=[],d=by(["group","mailbox"],b);for(e=0;e<d.length;e+=1)f=d[e],f.name==="group"?c.push(bA(f)):f.name==="mailbox"&&c.push(bB(f));return g={ast:b,addresses:c},a.simple&&(g=bD(g)),a.oneResult?bE(g):a.simple?g&&g.addresses:g}function bA(a){var b,c=bw("display-name",a),d=[],e=by(["mailbox"],a);for(b=0;b<e.length;b+=1)d.push(bB(e[b]));return{node:a,parts:{name:c},type:a.name,name:bC(c),addresses:d}}function bB(a){var b=bw("display-name",a),c=bw("addr-spec",a),d=bx("cfws",a),e=bw("local-part",c),f=bw("domain",c);return{node:a,parts:{name:b,address:c,local:e,domain:f,comments:d},type:a.name,name:bC(b),address:bC(c),local:bC(e),domain:bC(f),groupName:bC(a.groupName)}}function bC(a){return a!==null&&a!==undefined?a.semantic:null}function bD(a){var b;if(a&&a.addresses)for(b=0;b<a.addresses.length;b+=1)delete a.addresses[b].node;return a}function bE(b){return b?!a.partial&&b.addresses.length>1?null:b.addresses&&b.addresses[0]:null}var bF,bG,bH,bI,bJ;a=h(a,{});if(a===null)return null;bF=a.input,bJ={address:S,"address-list":Z,"angle-addr":V,from:be,group:W,mailbox:T,"mailbox-list":Y,"reply-to":bg,sender:bf}[a.startAt]||Z;if(!a.strict){g(),a.strict=!0,bI=bJ(bF);if(a.partial||!b())return bz(bI);a.strict=!1}return g(),bI=bJ(bF),!a.partial&&b()?null:bz(bI)}function c(a){return b(h(a,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))}function d(a){return b(h(a,{rfc6532:!0,simple:!0,startAt:"address-list"}))}function e(a){return b(h(a,{rfc6532:!0,simple:!0,startAt:"from"}))}function f(a){return b(h(a,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))}function g(a){return b(h(a,{rfc6532:!0,simple:!0,startAt:"reply-to"}))}function h(a,b){function c(a){return Object.prototype.toString.call(a)==="[object String]"}function d(a){return a===Object(a)}function e(a){return a===null||a===undefined}var f,g;if(c(a))a={input:a};else if(!d(a))return null;if(!c(a.input))return null;if(!b)return null;f={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1};for(g in f)e(a[g])&&(a[g]=e(b[g])?f[g]:b[g]);return a}"use strict",b.parseOneAddress=c,b.parseAddressList=d,b.parseFrom=e,b.parseSender=f,b.parseReplyTo=g,typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=b:a.emailAddresses=b})(this);